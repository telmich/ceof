\chapter{Analysis of features and security requirements}

2. Requirement analysis

- no real time -> within minutes
    - eventual consistency / asynchronous?

\section{Abstract}
EOF is a chat protocol that supports secure chatting.
Secure chatting consists of the following features:
\begin{enumerate}
\item Nobody, but the intended receiver(s) know(s) \emph{that} you wrote a message.
\item Nobody, but the intended receiver(s) can view the \emph{message content}.
\item Nobody, but the intended receiver(s) can \emph{verify} the source of the message being you.
\item Nobody, but the intended receiver(s) know(s) \emph{who} you sent a message to.
\item The network must survive attacks of a single attacker.
\item Hard (if not practilcally impossible) to block chatting.
\end{enumerate}
Additionally, for practical reasons, EOF must support the following
chat features:
\begin{enumerate}
\item Direct chat ("`message is only seen by one person"')
\item Group chat ("`message is sent to specific group, which may consist of
more than one person"')
\end{enumerate}
% Nico: 1.0
% -----------------------------------------------------------------------------
\section{Hide message sending}
We don't think it's possible to hide that you are part of the chat network,
because some heuristics will be developed to detect the chat packets.
So we use a different idea:
Every participant of an EOF network will constantly send chat packets
with a pre-defined frequency (for instance every 250 ms).
If you don't chat, \emph{noise} is sent.\footnote{Noise is just random
data, see below for a more detailled description of noise.}
The noise is also used to defend against timing analysis.
In case you are sending out a message, the message packet will be added to the
queue and sent within the next free time slot.

From outside it can easily be seen, that you are part of the network,
but not, if you sent a message.
% Nico: 1.0
% -----------------------------------------------------------------------------
\section{Hide message content}
We encrypt every message via public-key cryptography\cite{pgp-1},
so that only the receiver can decrypt and view the message content.
% Nico: 1.0
% -----------------------------------------------------------------------------
\section{Verify sender}
Before the encrypt the packet, it is signed via public-key
cryptography\cite{pgp-1}. Thus only the receiver can verify the message sender.
% Nico: 1.0
% -----------------------------------------------------------------------------
\section{Hide message receiver}
The message packets are always sent indirectly via onion routing\cite{onion-1}.
The idea is taken from the Tor project\cite{tor-1}, though EOF uses an enhanced
version: EOF does not know about entry or exit nodes. If you are the intended
receiver you may or may not continue to forward the message, which is defined
by the sender of the message. That said, EOF must use source
routing\cite{source-routing-1}.

To support onion routing, the sender of a packet needs to encrypt the packet
multiple times, once for each host that receives the packet. This may look
as follows:
\begin{enumerate}
\item Create message (from noise or user input)
\item Create source path
\item Create packet for last peer ("`pkg-last"')
\item Create packet for last-1 peer including \emph{pkg-last}
\item Continue until first peer is reached
\item Sent packet to first peer
\end{enumerate}
Thus every peer only knows the previous and the next peer.
% Nico: 1.0
% -----------------------------------------------------------------------------
\section{Reliable against single user attacks}
Traditional chat networks depend on one or more central organised servers.
An attacker can stop all communication, if she runs a successful denial
of service ("`DoS"') attack against the central systems.
To protect against this, EOF uses a dynamic peer-to-peer network, which works
as long as the minimun number of peers and the destination peer is available.
It has no dependency on a central server.
% Nico: 1.0
% -----------------------------------------------------------------------------
\section{Hide packets in network stream}
As said before, we don't think it's possible to hide the participation in the
chat network. To be able to send packets, although an attacker \emph{knows}
about the participation, EOF embeds all chat packets into other (well known)
protocols (which is knows as steganography\cite{stegano-1}).
EOF does not implement nor specify \emph{transport protocols} itself.
The EOF community is urged to implement them in a creative way: Usage
of well-known protocols like TCP\cite{tcp-1}, HTTP\cite{http-1},
SMTP\cite{smtp-1} or even transmission of packets on avian
carriers\cite{avian-1} are encouraged. The tunneling of EOF packets through
those protocols (also know as obfuscation) makes it harder to detect
and \emph{block} EOF traffic.
If an attacker wants you to stop sending messages, she has to completly
remove you from the network, because any open protocol may be (ab)used to
encapsulate EOF packets into it.
% Nico: 1.0
% -----------------------------------------------------------------------------
\section{Real world usability}
To be able to be compete with other chat protocols, EOF needs
to support \emph{direct} and \emph{group chat}, which is
implemented by two different chat destinations:
\begin{enumerate}
\item \emph{Peers}
\item \emph{Groups of peers}
\end{enumerate}
A peer is just another person (direct chat), a group of peers is the EOF
equivalent of the IRC channel\cite{irc-1}. As there is no central server,
groups of peers are managed by each client, and thus the compositions of
group members may be different on different peers.
% Nico: 1.0

